"use strict";

// Pop up newsletter
var popupNewsletter = document.querySelector('#popup-newsletter-block');
var popupNewsletterMain = document.querySelector('#popup-newsletter-block .popup-newsletter-main');
var closePopupNewsletterBtn = document.querySelector('#popup-newsletter-block .close-block');
window.onload = function () {
  if (popupNewsletter) {
    setTimeout(function () {
      popupNewsletter.classList.add('open');
    }, 400);
  }
};
if (closePopupNewsletterBtn) {
  closePopupNewsletterBtn.addEventListener('click', function () {
    popupNewsletter.classList.remove('open');
  });
}

// click outside mobile menu, close mobile menu
if (popupNewsletter) {
  popupNewsletter.addEventListener('click', function () {
    popupNewsletter.classList.remove('open');
  });
}

// prevent default behavior when clicking mobile menu
if (popupNewsletterMain) {
  popupNewsletterMain.addEventListener('click', function (event) {
    event.stopPropagation();
  });
}

// header menu sticky when scroll
window.addEventListener('scroll', function () {
  var headerMenu = document.querySelector('.header-menu');
  if (headerMenu) {
    headerMenu.classList.toggle('sticky', window.scrollY > 700);
  }
});

// mobile menu
var mobileMenuBtn = document.querySelector('.menu-humburger i');
var menuMobile = document.querySelector('#menu-mobile-block');
var menuMobileMain = document.querySelector('#menu-mobile-block .menu-mobile-main');
var closeMobileBtn = document.querySelector('#menu-mobile-block .close-block');
var subMenuMobile = document.querySelectorAll('#menu-mobile-block .sub-nav-mobile');

// click menu humburger icon, show mobile menu
if (mobileMenuBtn) {
  mobileMenuBtn.addEventListener('click', function () {
    menuMobile.classList.add('open');
  });
}
var itemLinks = document.querySelectorAll('#menu-mobile-block ul li');
itemLinks.forEach(function (item) {
  item.addEventListener('click', function () {
    item.querySelector('.sub-nav-mobile').classList.toggle('open');
  });
  var backIcon = document.querySelector('.sub-nav-mobile .back-block');
  backIcon.addEventListener('click', function () {
    subMenuMobile.classList.remove('open');
  });
});

// click icon close, close mobile menu
if (closeMobileBtn) {
  closeMobileBtn.addEventListener('click', function () {
    menuMobile.classList.remove('open');
  });
}

// click outside mobile menu, close mobile menu
if (menuMobile) {
  menuMobile.addEventListener('click', function () {
    menuMobile.classList.remove('open');
  });
}

// prevent default behavior when clicking mobile menu
if (menuMobileMain) {
  menuMobileMain.addEventListener('click', function (event) {
    event.stopPropagation();
  });
}

// change type pricing
var chooseType = document.querySelector('.choose-type');
var listPricing = document.querySelectorAll('.list-pricing');
if (chooseType) {
  chooseType.onclick = function (selectedItem) {
    if (selectedItem.target.classList.contains("button")) {
      // add active class
      chooseType.querySelector('.active').classList.remove('active');
      selectedItem.target.classList.add('active');

      //get data-name value
      var filterName = selectedItem.target.getAttribute('data-name');
      listPricing.forEach(function (item) {
        if (filterName === item.getAttribute('data-name')) {
          item.classList.add('show');
          item.classList.remove('hide');
        } else {
          item.classList.remove('show');
          item.classList.add('hide');
        }
      });
    }
  };
}

// open answer faqs
var questionItem = document.querySelectorAll('.question-item');
if (questionItem) {
  questionItem.forEach(function (item, index) {
    var titleItem = item.querySelector('.question-item-main');
    var icon = item.querySelector('i');
    titleItem.addEventListener('click', function () {
      item.classList.toggle('open');
      if (item.classList.contains('open')) {
        setTimeout(function () {
          icon.classList.replace('ph-plus', 'ph-minus');
        }, 200);
      } else {
        setTimeout(function () {
          icon.classList.replace('ph-minus', 'ph-plus');
        }, 200);
      }
      removeOpen(index);
    });
    if (item.classList.contains('open')) {
      icon.classList.replace('ph-plus', 'ph-minus');
    } else {
      icon.classList.replace('ph-minus', 'ph-plus');
    }
  });
}
function removeOpen(index1) {
  questionItem.forEach(function (item2, index2) {
    if (index1 != index2) {
      item2.classList.remove('open');
      item2.querySelector('i').classList.replace('ph-minus', 'ph-plus');
    }
  });
}

// Like Blog Detail
var comments = document.querySelectorAll('.blog-detail .blog-comment .comment-item .like');
if (comments) {
  comments.forEach(function (cmt) {
    cmt.addEventListener('click', function () {
      cmt.classList.toggle('liked');
      var heartIcon = cmt.querySelector('i');
      var numberLiked = cmt.querySelector('.text-button-small');
      var number = parseFloat(numberLiked.innerHTML);
      if (cmt.classList.contains('liked')) {
        heartIcon.classList.replace('ph', 'ph-fill');
        number = number + 1;
        numberLiked.innerHTML = number.toString();
      } else {
        heartIcon.classList.replace('ph-fill', 'ph');
        number = number - 1;
        numberLiked.innerHTML = number.toString();
      }
    });
  });
}

// Show, hide reply
// const showReplyBtn = document.querySelectorAll('.blog-detail .blog-comment .comment-item .cmt .text-button-small')
// const replies = document.querySelectorAll('.blog-detail .blog-comment .reply')

// if(showReplyBtn) {
//   showReplyBtn.forEach(btn => {
//     btn.addEventListener('click', () => {

//     })
//   })
// }

// Testimonial Home1
$(".testimonial-block.style-one .container .row .list-avatar .avatar").slick({
  dots: false,
  arrows: true,
  prevArrow: '.prev-btn',
  nextArrow: '.next-btn',
  slidesToShow: 5,
  slidesToScroll: 5,
  touchThreshold: 100,
  swipe: true,
  swipeToSlide: true,
  autoplay: false,
  centerMode: true,
  pauseOnFocus: false,
  pauseOnHover: false,
  pauseOnDotsHover: false,
  infinite: true,
  responsive: [{
    breakpoint: 992,
    settings: {
      slidesToShow: 3,
      slidesToScroll: 3
    }
  }, {
    breakpoint: 768,
    settings: {
      slidesToShow: 3,
      slidesToScroll: 3
    }
  }]
});

// Change avatar testimonial home1
var prevBtn = document.querySelector('.testimonial-block.style-one .list-avatar .prev-btn');
var nextBtn = document.querySelector('.testimonial-block.style-one .list-avatar .next-btn');
var listCmt = document.querySelector('.testimonial-block.style-one .list-comment');
var commentItems = document.querySelectorAll('.testimonial-block.style-one .list-comment .cmt-item');

// Listen event click prev btn 
if (prevBtn) {
  prevBtn.addEventListener('click', function () {
    commentItems.forEach(function (item) {
      var indexCmt = item.getAttribute('data-name');
      var avatarCurrent = document.querySelector('.testimonial-block.style-one .list-avatar .slick-current');
      var indexAvatar = avatarCurrent.getAttribute('data-name');
      if (indexCmt === indexAvatar) {
        listCmt.querySelector('.active').classList.remove('active');
        item.classList.add('active');
      }
    });
  });
}

// Listen event click next btn 
if (nextBtn) {
  nextBtn.addEventListener('click', function () {
    commentItems.forEach(function (item) {
      var indexCmt = item.getAttribute('data-name');
      var avatarCurrent = document.querySelector('.testimonial-block.style-one .list-avatar .slick-current');
      var indexAvatar = avatarCurrent.getAttribute('data-name');
      if (indexCmt === indexAvatar) {
        listCmt.querySelector('.active').classList.remove('active');
        item.classList.add('active');
      }
    });
  });
}

// Listen event slide list avatar 
var slickList = document.querySelector('.testimonial-block.style-one .list-avatar .slick-list');
if (slickList) {
  slickList.addEventListener('mousemove', function (e) {
    commentItems.forEach(function (item) {
      var indexCmt = item.getAttribute('data-name');
      var avatarCurrent = document.querySelector('.testimonial-block.style-one .list-avatar .slick-current');
      var indexAvatar = avatarCurrent.getAttribute('data-name');
      if (indexCmt === indexAvatar) {
        listCmt.querySelector('.active').classList.remove('active');
        item.classList.add('active');
      }
    });
  });
}

// change active nav - Projects Home1
var listNav = document.querySelectorAll('.list-nav');
var filterItem = document.querySelectorAll('.item-filter');
if (listNav) {
  listNav.forEach(function (listNavItem) {
    listNavItem.onclick = function (selectedItem) {
      if (selectedItem.target.classList.contains("nav-item")) {
        // add active class
        listNavItem.querySelector('.active').classList.remove('active');
        selectedItem.target.classList.add('active');

        //get data-name value
        var filterName = selectedItem.target.getAttribute('data-name');
        filterItem.forEach(function (item) {
          if (filterName === item.getAttribute('data-name')) {
            item.classList.add('show');
            item.classList.remove('hide');
          } else {
            item.classList.remove('show');
            item.classList.add('hide');
          }
        });
      }
    };
  });
}

// Blogs home1
$(".list-blog .container .list").slick({
  dots: true,
  arrows: false,
  slidesToShow: 3,
  slidesToScroll: 4,
  touchThreshold: 100,
  swipe: true,
  swipeToSlide: true,
  autoplay: false,
  autoplaySpeed: 3000,
  speed: 500,
  pauseOnFocus: false,
  pauseOnHover: false,
  pauseOnDotsHover: false,
  infinite: true,
  responsive: [{
    breakpoint: 1170,
    settings: {
      slidesToShow: 2,
      slidesToScroll: 1
    }
  }, {
    breakpoint: 992,
    settings: {
      slidesToShow: 2,
      slidesToScroll: 1
    }
  }, {
    breakpoint: 768,
    settings: {
      slidesToShow: 1,
      slidesToScroll: 1
    }
  }]
});

// Change cursor
var listBlog = document.querySelectorAll('.list-blog .slick-list');
var mouseCursor = document.querySelector('.cursor');
if (listBlog) {
  listBlog.forEach(function (listNew) {
    listNew.addEventListener('mousemove', function (e) {
      mouseCursor.style.top = e.pageY + 'px';
      mouseCursor.style.left = e.pageX + 'px';
      mouseCursor.style.opacity = '1';
    });
    listNew.addEventListener('mouseout', function (e) {
      mouseCursor.style.opacity = '0';
    });
    listNew.addEventListener('mousedown', function () {
      mouseCursor.style.width = '60px';
      mouseCursor.style.height = '60px';
      mouseCursor.style.gap = '4px';
    });
    listNew.addEventListener('mouseup', function () {
      mouseCursor.style.width = '70px';
      mouseCursor.style.height = '70px';
      mouseCursor.style.gap = '12px';
    });
  });
}

// Testimonial Home4
$(".testimonial-block.style-four .container .row .list-testimonial").slick({
  dots: false,
  arrows: true,
  prevArrow: '.prev-btn',
  nextArrow: '.next-btn',
  slidesToShow: 1,
  slidesToScroll: 2,
  touchThreshold: 100,
  swipe: true,
  swipeToSlide: true,
  autoplay: false,
  pauseOnFocus: false,
  pauseOnHover: false,
  pauseOnDotsHover: false,
  infinite: true,
  responsive: [{
    breakpoint: 992,
    settings: {
      slidesToShow: 2,
      slidesToScroll: 2
    }
  }, {
    breakpoint: 768,
    settings: {
      slidesToShow: 1,
      slidesToScroll: 1
    }
  }]
});